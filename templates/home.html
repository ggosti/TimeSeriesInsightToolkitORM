<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Groups and Records Viewer</title>
     <style>
        /* Dark Mode Styling */
        body {
            font-family: monospace, sans-serif;
            background-color: #1e1e1e;
            color: #f0f0f0;
            margin: 20px;
        }
        h1, h2 {
            color: #ffffff;
        }
        .entity-section {
            margin-bottom: 30px;
        }
        .entity-list {
            margin-top: 10px;
            padding-left: 20px;
        }
        .entity-item {
            margin-bottom: 5px;
        }
        a {
            color: #4caf50;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        /* Links styling */
        .entity-item a {
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .entity-item a:hover {
            background-color: #333;
        }
    </style>
</head>
<body>

<h1>Groups and Records Viewer</h1>

<!-- Section to display events -->
<div class="entity-section" id="events-section">
    <h2>Events</h2>
    <ul class="entity-list" id="events-list"></ul>
</div>

<!-- Section to display groups (will be populated when clicking on a event) -->
<div class="entity-section" id="groups-section" style="display:none;">
    <h2>Groups</h2>
    <ul class="entity-list" id="groups-list"></ul>
</div>

<!-- Section to display records (will be populated when clicking on a group) -->
<div class="entity-section" id="records-section" style="display:none;">
    <h2>Records</h2>
    <ul class="entity-list" id="records-list"></ul>
</div>

<script>
    // Replace these with dynamic values or selections
    const stepName = 'proc';
    // const eventName = 'event1';

    // Function to fetch and display events for a step
    function fetchEvents() {
        const url = `/api/steps/${stepName}/events`;
        fetch(url)
            .then(response => response.json())
            .then(data => {
                const eventsList = document.getElementById('events-list');
                eventsList.innerHTML = ''; // Clear the list first

                data.forEach(event => {
                    const listItem = document.createElement('li');
                    listItem.className = 'entity-item';
                    listItem.innerHTML = `<a href="#" onclick="fetchGroups('${event.name}')">${event.name}</a>`;
                    eventsList.appendChild(listItem);
                });
            })
            .catch(error => console.error('Error fetching events:', error));
    }

    // Function to fetch and display groups for a step and event
    function fetchGroups(eventName) {
        const url = `/api/steps/${stepName}/events/${eventName}/groups`;
        fetch(url)
            .then(response => response.json())
            .then(data => {
                const groupsSection = document.getElementById('groups-section');
                const groupsList = document.getElementById('groups-list');
                groupsList.innerHTML = ''; // Clear the list first

                data.forEach(group => {
                    const listItem = document.createElement('li');
                    listItem.className = 'entity-item';
                    listItem.innerHTML = `<a href="#" onclick="fetchRecords('${eventName}','${group.name}')">${group.name}</a>`;
                    groupsList.appendChild(listItem);
                });

                // Show the groups section
                groupsSection.style.display = 'block';
            })
            .catch(error => console.error('Error fetching groups:', error));
    }

    // Function to fetch and display records for a selected group
    function fetchRecords(eventName, groupName) {
        const url = `/api/steps/${stepName}/events/${eventName}/groups/${groupName}/records`;
        fetch(url)
            .then(response => response.json())
            .then(data => {
                const recordsSection = document.getElementById('records-section');
                const recordsList = document.getElementById('records-list');
                recordsList.innerHTML = ''; // Clear the list first

                data.forEach(record => {
                    const listItem = document.createElement('li');
                    listItem.className = 'entity-item';
                    listItem.textContent = record.name;
                    recordsList.appendChild(listItem);
                });

                // Show the records section
                recordsSection.style.display = 'block';
            })
            .catch(error => console.error('Error fetching records:', error));
    }

    // Fetch and display the events when the page loads
    document.addEventListener('DOMContentLoaded', fetchEvents);
</script>

</body>
</html>
